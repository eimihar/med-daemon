# Malaysian Clinical Practice Guidelines (CPG)

## Overview

This document provides comprehensive documentation on Malaysian Clinical Practice Guidelines (CPG), including official Ministry of Health Malaysia CPGs and specialty society guidelines relevant to medical practitioners in Malaysia.

---

## 1. Ministry of Health Malaysia (MOH) CPG Portal

### Main Portal
- **URL**: https://www.moh.gov.my/index.php/pages/view/clinical-practice-guidelines
- **Content**: Official Ministry-approved clinical practice guidelines
- **Format**: PDF downloads
- **Access**: Free, publicly available
- **Language**: English (primary), Bahasa Malaysia (some)

### CPG Categories

#### A. Non-Communicable Diseases (NCD)

| CPG Title | Year | URL |
|-----------|------|-----|
| Clinical Practice Guidelines: Management of Type 2 Diabetes Mellitus | 2020 | moh.gov.my |
| Clinical Practice Guidelines: Management of Hypertension | 2018 | moh.gov.my |
| Clinical Practice Guidelines: Management of Dyslipidaemia | 2017 | moh.gov.my |
| Clinical Practice Guidelines: Management of Obesity | 2004 | moh.gov.my |
| Clinical Practice Guidelines: Prevention, Diagnosis & Management of Osteoporosis | 2015 | moh.gov.my |
| Clinical Practice Guidelines: Management of Asthma | 2017 | moh.gov.my |
| Clinical Practice Guidelines: Management of Chronic Obstructive Pulmonary Disease (COPD) | 2020 | moh.gov.my |
| Clinical Practice Guidelines: Management of Acute Coronary Syndrome | 2019 | moh.gov.my |
| Clinical Practice Guidelines: Management of Heart Failure | 2019 | moh.gov.my |
| Clinical Practice Guidelines: Prevention of Cardiovascular Disease | 2017 | moh.gov.my |
| Clinical Practice Guidelines: Management of Diabetes Nephropathy | 2014 | moh.gov.my |
| Clinical Practice Guidelines: Management of Diabetic Retinopathy | 2016 | moh.gov.my |
| Clinical Practice Guidelines: Management of Diabetic Foot | 2018 | moh.gov.my |
| Clinical Practice Guidelines: Screening of Diabetic Retinopathy | 2020 | moh.gov.my |
| Clinical Practice Guidelines: Management of Depression | 2019 | moh.gov.my |
| Clinical Practice Guidelines: Management of Anxiety Disorders | 2019 | moh.gov.my |
| Clinical Practice Guidelines: Management of Schizophrenia | 2019 | moh.gov.my |
| Clinical Practice Guidelines: Management of Bipolar Disorder | 2020 | moh.gov.my |

#### B. Communicable Diseases

| CPG Title | Year | URL |
|-----------|------|-----|
| Clinical Practice Guidelines: Management of Dengue | 2023 | moh.gov.my |
| Clinical Practice Guidelines: Management of Tuberculosis | 2022 | moh.gov.my |
| Clinical Practice Guidelines: Prevention and Treatment of HIV | 2022 | moh.gov.my |
| Clinical Practice Guidelines: Management of COVID-19 | 2023 | moh.gov.my |
| Clinical Practice Guidelines: Management of Malaria | 2019 | moh.gov.my |
| Clinical Practice Guidelines: Management of Leptospirosis | 2017 | moh.gov.my |
| Clinical Practice Guidelines: Management of Hand, Foot and Mouth Disease (HFMD) | 2020 | moh.gov.my |
| Clinical Practice Guidelines: Management of Nipah Virus Infection | 2018 | moh.gov.my |
| Clinical Practice Guidelines: Management of Measles | 2015 | moh.gov.my |
| Clinical Practice Guidelines: Management of Hepatitis B | 2019 | moh.gov.my |
| Clinical Practice Guidelines: Management of Hepatitis C | 2019 | moh.gov.my |
| Clinical Practice Guidelines: Management of Typhoid and Paratyphoid Fever | 2018 | moh.gov.my |
| Clinical Practice Guidelines: Management of Rabies | 2021 | moh.gov.my |
| Clinical Practice Guidelines: Management of Brucellosis | 2016 | moh.gov.my |
| Clinical Practice Guidelines: Management of Melioidosis | 2018 | moh.gov.my |
| Clinical Practice Guidelines: Management of Scrub Typhus | 2017 | moh.gov.my |

#### C. Maternal and Child Health

| CPG Title | Year | URL |
|-----------|------|-----|
| Clinical Practice Guidelines: Antenatal Care | 2019 | moh.gov.my |
| Clinical Practice Guidelines: Management of Postpartum Haemorrhage | 2016 | moh.gov.my |
| Clinical Practice Guidelines: Management of Pre-eclampsia/Eclampsia | 2019 | moh.gov.my |
| Clinical Practice Guidelines: Management of Gestational Diabetes Mellitus | 2017 | moh.gov.my |
| Clinical Practice Guidelines: Management of Preterm Labour | 2019 | moh.gov.my |
| Clinical Practice Guidelines: Management of Induction of Labour | 2018 | moh.gov.my |
| Clinical Practice Guidelines: Neonatal Resuscitation | 2016 | moh.gov.my |
| Clinical Practice Guidelines: Management of Jaundice in Newborns | 2019 | moh.gov.my |
| Clinical Practice Guidelines: Immunisation Schedule | 2020 | moh.gov.my |
| Clinical Practice Guidelines: Management of Acute Gastroenteritis in Children | 2019 | moh.gov.my |
| Clinical Practice Guidelines: Management of Pneumonia in Children | 2018 | moh.gov.my |
| Clinical Practice Guidelines: Management of Sepsis in Children | 2020 | moh.gov.my |

#### D. Emergency and Critical Care

| CPG Title | Year | URL |
|-----------|------|-----|
| Clinical Practice Guidelines: Emergency Triage System | 2016 | moh.gov.my |
| Clinical Practice Guidelines: Management of Sepsis in Adults | 2020 | moh.gov.my |
| Clinical Practice Guidelines: Management of Acute Breathlessness | 2018 | moh.gov.my |
| Clinical Practice Guidelines: Management of Chest Pain | 2019 | moh.gov.my |
| Clinical Practice Guidelines: Management of Acute Stroke | 2020 | moh.gov.my |
| Clinical Practice Guidelines: Management of Acute Asthma in Adults | 2019 | moh.gov.my |
| Clinical Practice Guidelines: Management of Anaphylaxis | 2017 | moh.gov.my |
| Clinical Practice Guidelines: Management of Poisoning | 2018 | moh.gov.my |
| Clinical Practice Guidelines: Management of Near Drowning | 2016 | moh.gov.my |
| Clinical Practice Guidelines: Management of Trauma | 2020 | moh.gov.my |
| Clinical Practice Guidelines: Management of Heat-Related Illness | 2018 | moh.gov.my |

#### E. Infectious Diseases and Infection Control

| CPG Title | Year | URL |
|-----------|------|-----|
| Clinical Practice Guidelines: Antibiotic Usage | 2019 | moh.gov.my |
| Clinical Practice Guidelines: Antimicrobial Prophylaxis in Surgery | 2018 | moh.gov.my |
| Clinical Practice Guidelines: Prevention and Control of COVID-19 | 2023 | moh.gov.my |
| Clinical Practice Guidelines: Hand Hygiene | 2019 | moh.gov.my |
| Clinical Practice Guidelines: Management of Hospital-Acquired Infections | 2018 | moh.gov.my |
| Clinical Practice Guidelines: Management of Surgical Site Infection | 2017 | moh.gov.my |
| Clinical Practice Guidelines: Management of Catheter-Associated Urinary Tract Infection | 2018 | moh.gov.my |
| Clinical Practice Guidelines: Management of Central Line-Associated Bloodstream Infection | 2019 | moh.gov.my |

#### F. Surgery and Anesthesia

| CPG Title | Year | URL |
|-----------|------|-----|
| Clinical Practice Guidelines: Anaesthesia | 2020 | moh.gov.my |
| Clinical Practice Guidelines: Perioperative Fasting | 2019 | moh.gov.my |
| Clinical Practice Guidelines: Management of Postoperative Pain | 2018 | moh.gov.my |
| Clinical Practice Guidelines: Venous Thromboembolism Prophylaxis | 2019 | moh.gov.my |
| Clinical Practice Guidelines: Blood Transfusion | 2020 | moh.gov.my |
| Clinical Practice Guidelines: Management of Surgical Patients on Antiplatelet/Anticoagulant | 2019 | moh.gov.my |

#### G. Oncology

| CPG Title | Year | URL |
|-----------|------|-----|
| Clinical Practice Guidelines: Management of Breast Cancer | 2020 | moh.gov.my |
| Clinical Practice Guidelines: Management of Colorectal Cancer | 2019 | moh.gov.my |
| Clinical Practice Guidelines: Management of Lung Cancer | 2018 | moh.gov.my |
| Clinical Practice Guidelines: Management of Cervical Cancer | 2019 | moh.gov.my |
| Clinical Practice Guidelines: Management of Prostate Cancer | 2018 | moh.gov.my |
| Clinical Practice Guidelines: Management of Nasopharyngeal Cancer | 2017 | moh.gov.my |
| Clinical Practice Guidelines: Palliative Care | 2019 | moh.gov.my |

#### H. Renal and Urology

| CPG Title | Year | URL |
|-----------|------|-----|
| Clinical Practice Guidelines: Management of Chronic Kidney Disease | 2018 | moh.gov.my |
| Clinical Practice Guidelines: Management of Acute Kidney Injury | 2019 | moh.gov.my |
| Clinical Practice Guidelines: Haemodialysis | 2020 | moh.gov.my |
| Clinical Practice Guidelines: Peritoneal Dialysis | 2019 | moh.gov.my |
| Clinical Practice Guidelines: Management of Urinary Tract Infection | 2018 | moh.gov.my |
| Clinical Practice Guidelines: Management of Urinary Stones | 2017 | moh.gov.my |
| Clinical Practice Guidelines: Management of Benign Prostatic Hyperplasia | 2016 | moh.gov.my |

#### I. Neurology

| CPG Title | Year | URL |
|-----------|------|-----|
| Clinical Practice Guidelines: Management of Epilepsy | 2020 | moh.gov.my |
| Clinical Practice Guidelines: Management of Migraine | 2019 | moh.gov.my |
| Clinical Practice Guidelines: Management of Parkinson's Disease | 2018 | moh.gov.my |
| Clinical Practice Guidelines: Management of Multiple Sclerosis | 2017 | moh.gov.my |
| Clinical Practice Guidelines: Management of Stroke | 2020 | moh.gov.my |

#### J. Gastroenterology

| CPG Title | Year | URL |
|-----------|------|-----|
| Clinical Practice Guidelines: Management of Peptic Ulcer Disease | 2019 | moh.gov.my |
| Clinical Practice Guidelines: Management of Gastroesophageal Reflux Disease (GERD) | 2018 | moh.gov.my |
| Clinical Practice Guidelines: Management of Inflammatory Bowel Disease | 2020 | moh.gov.my |
| Clinical Practice Guidelines: Management of Viral Hepatitis | 2019 | moh.gov.my |
| Clinical Practice Guidelines: Management of Liver Cirrhosis | 2018 | moh.gov.my |
| Clinical Practice Guidelines: Management of Acute Pancreatitis | 2017 | moh.gov.my |

---

## 2. MOH CPG Implementation

### CPG Metadata Structure

```python
from dataclasses import dataclass
from typing import List, Optional
from enum import Enum

class CPGCategory(Enum):
    NON_COMMUNICABLE_DISEASES = "Non-Communicable Diseases"
    COMMUNICABLE_DISEASES = "Communicable Diseases"
    MATERNAL_CHILD_HEALTH = "Maternal and Child Health"
    EMERGENCY_CRITICAL_CARE = "Emergency and Critical Care"
    INFECTION_CONTROL = "Infectious Diseases & Infection Control"
    SURGERY_ANESTHESIA = "Surgery and Anesthesia"
    ONCOLOGY = "Oncology"
    RENAL_UROLOGY = "Renal and Urology"
    NEUROLOGY = "Neurology"
    GASTROENTEROLOGY = "Gastroenterology"

class CPGStatus(Enum):
    CURRENT = "Current"
    UNDER_REVIEW = "Under Review"
    ARCHIVED = "Archived"

@dataclass
class CPG:
    """Represents a Malaysian Clinical Practice Guideline."""
    title: str
    category: CPGCategory
    organization: str  # e.g., "Ministry of Health Malaysia"
    year: int
    version: str
    status: CPGStatus
    url: str
    pdf_path: Optional[str] = None
    keywords: List[str] = None
    
    def __post_init__(self):
        if self.keywords is None:
            self.keywords = []
    
    def to_dict(self) -> dict:
        return {
            "title": self.title,
            "category": self.category.value,
            "organization": self.organization,
            "year": self.year,
            "version": self.version,
            "status": self.status.value,
            "url": self.url,
            "keywords": self.keywords
        }
```

### CPG Database

```python
class CPGDatabase:
    """Database of Malaysian Clinical Practice Guidelines."""
    
    def __init__(self):
        self.cpgs: List[CPG] = []
    
    def add(self, cpg: CPG):
        self.cpgs.append(cpg)
    
    def search_by_title(self, query: str) -> List[CPG]:
        query_lower = query.lower()
        return [c for c in self.cpgs 
                if query_lower in c.title.lower()]
    
    def search_by_category(self, category: CPGCategory) -> List[CPG]:
        return [c for c in self.cpgs if c.category == category]
    
    def search_by_year(self, year: int) -> List[CPG]:
        return [c for c in self.cpgs if c.year == year]
    
    def search_by_keywords(self, keywords: List[str]) -> List[CPG]:
        results = []
        for cpg in self.cpgs:
            for keyword in keywords:
                if keyword.lower() in cpg.title.lower() or \
                   keyword.lower() in [k.lower() for k in cpg.keywords]:
                    results.append(cpg)
                    break
        return results
    
    def get_by_title(self, title: str) -> Optional[CPG]:
        for c in self.cpgs:
            if c.title.lower() == title.lower():
                return c
        return None
    
    def get_latest_by_category(self, category: CPGCategory) -> List[CPG]:
        category_cpgs = self.search_by_category(category)
        return sorted(category_cpgs, key=lambda x: x.year, reverse=True)


# Populate with MOH CPGs
def create_moh_cpg_database() -> CPGDatabase:
    db = CPGDatabase()
    
    # Non-Communicable Diseases
    cpg_list = [
        CPG(
            title="Clinical Practice Guidelines: Management of Type 2 Diabetes Mellitus",
            category=CPGCategory.NON_COMMUNICABLE_DISEASES,
            organization="Ministry of Health Malaysia",
            year=2020,
            version="2nd Edition",
            status=CPGStatus.CURRENT,
            url="https://www.moh.gov.my",
            keywords=["diabetes", "T2DM", "blood glucose", "HbA1c", "metformin"]
        ),
        CPG(
            title="Clinical Practice Guidelines: Management of Hypertension",
            category=CPGCategory.NON_COMMUNICABLE_DISEASES,
            organization="Ministry of Health Malaysia",
            year=2018,
            version="3rd Edition",
            status=CPGStatus.CURRENT,
            url="https://www.moh.gov.my",
            keywords=["hypertension", "blood pressure", "BP", "antihypertensive"]
        ),
        CPG(
            title="Clinical Practice Guidelines: Management of Dyslipidaemia",
            category=CPGCategory.NON_COMMUNICABLE_DISEASES,
            organization="Ministry of Health Malaysia",
            year=2017,
            version="2nd Edition",
            status=CPGStatus.CURRENT,
            url="https://www.moh.gov.my",
            keywords=["dyslipidaemia", "cholesterol", "LDL", "HDL", "statin"]
        ),
        CPG(
            title="Clinical Practice Guidelines: Management of Asthma",
            category=CPGCategory.NON_COMMUNICABLE_DISEASES,
            organization="Ministry of Health Malaysia",
            year=2017,
            version="2nd Edition",
            status=CPGStatus.CURRENT,
            url="https://www.moh.gov.my",
            keywords=["asthma", "bronchial", "inhaler", "GINA"]
        ),
        CPG(
            title="Clinical Practice Guidelines: Management of Chronic Obstructive Pulmonary Disease (COPD)",
            category=CPGCategory.NON_COMMUNICABLE_DISEASES,
            organization="Ministry of Health Malaysia",
            year=2020,
            version="2nd Edition",
            status=CPGStatus.CURRENT,
            url="https://www.moh.gov.my",
            keywords=["COPD", "emphysema", "bronchitis", "GOLD"]
        ),
        CPG(
            title="Clinical Practice Guidelines: Management of Acute Coronary Syndrome",
            category=CPGCategory.NON_COMMUNICABLE_DISEASES,
            organization="Ministry of Health Malaysia",
            year=2019,
            version="2nd Edition",
            status=CPGStatus.CURRENT,
            url="https://www.moh.gov.my",
            keywords=["ACS", "MI", "myocardial infarction", "STEMI", "NSTEMI", "PCI"]
        ),
        CPG(
            title="Clinical Practice Guidelines: Management of Heart Failure",
            category=CPGCategory.NON_COMMUNICABLE_DISEASES,
            organization="Ministry of Health Malaysia",
            year=2019,
            version="2nd Edition",
            status=CPGStatus.CURRENT,
            url="https://www.moh.gov.my",
            keywords=["heart failure", "HF", "HFpEF", "HFrEF", "NYHA"]
        ),
        CPG(
            title="Clinical Practice Guidelines: Management of Depression",
            category=CPGCategory.NON_COMMUNICABLE_DISEASES,
            organization="Ministry of Health Malaysia",
            year=2019,
            version="2nd Edition",
            status=CPGStatus.CURRENT,
            url="https://www.moh.gov.my",
            keywords=["depression", "major depressive disorder", "antidepressant", "SSRI"]
        ),
        # Communicable Diseases
        CPG(
            title="Clinical Practice Guidelines: Management of Dengue",
            category=CPGCategory.COMMUNICABLE_DISEASES,
            organization="Ministry of Health Malaysia",
            year=2023,
            version="4th Edition",
            status=CPGStatus.CURRENT,
            url="https://www.moh.gov.my",
            keywords=["dengue", "dengue fever", "DHF", "DSS", "Aedes"]
        ),
        CPG(
            title="Clinical Practice Guidelines: Management of Tuberculosis",
            category=CPGCategory.COMMUNICABLE_DISEASES,
            organization="Ministry of Health Malaysia",
            year=2022,
            version="3rd Edition",
            status=CPGStatus.CURRENT,
            url="https://www.moh.gov.my",
            keywords=["TB", "tuberculosis", "mycobacterium", "anti-TB", "Rifampicin"]
        ),
        CPG(
            title="Clinical Practice Guidelines: Prevention and Treatment of HIV",
            category=CPGCategory.COMMUNICABLE_DISEASES,
            organization="Ministry of Health Malaysia",
            year=2022,
            version="4th Edition",
            status=CPGStatus.CURRENT,
            url="https://www.moh.gov.my",
            keywords=["HIV", "AIDS", "ART", "antiretroviral", "PrEP", "PEP"]
        ),
        CPG(
            title="Clinical Practice Guidelines: Management of COVID-19",
            category=CPGCategory.COMMUNICABLE_DISEASES,
            organization="Ministry of Health Malaysia",
            year=2023,
            version="5th Edition",
            status=CPGStatus.CURRENT,
            url="https://www.moh.gov.my",
            keywords=["COVID-19", "SARS-CoV-2", "coronavirus", "Paxlovid", "molnupiravir"]
        ),
        CPG(
            title="Clinical Practice Guidelines: Management of Malaria",
            category=CPGCategory.COMMUNICABLE_DISEASES,
            organization="Ministry of Health Malaysia",
            year=2019,
            version="2nd Edition",
            status=CPGStatus.CURRENT,
            url="https://www.moh.gov.my",
            keywords=["malaria", "Plasmodium", "artemisinin", "falciparum", "vivax"]
        ),
        # Maternal and Child Health
        CPG(
            title="Clinical Practice Guidelines: Antenatal Care",
            category=CPGCategory.MATERNAL_CHILD_HEALTH,
            organization="Ministry of Health Malaysia",
            year=2019,
            version="2nd Edition",
            status=CPGStatus.CURRENT,
            url="https://www.moh.gov.my",
            keywords=["antenatal", "pregnancy", "prenatal", "ANC", "booking"]
        ),
        CPG(
            title="Clinical Practice Guidelines: Management of Pre-eclampsia/Eclampsia",
            category=CPGCategory.MATERNAL_CHILD_HEALTH,
            organization="Ministry of Health Malaysia",
            year=2019,
            version="2nd Edition",
            status=CPGStatus.CURRENT,
            url="https://www.moh.gov.my",
            keywords=["pre-eclampsia", "eclampsia", "hypertension in pregnancy", "PE"]
        ),
        CPG(
            title="Clinical Practice Guidelines: Management of Postpartum Haemorrhage",
            category=CPGCategory.MATERNAL_CHILD_HEALTH,
            organization="Ministry of Health Malaysia",
            year=2016,
            version="2nd Edition",
            status=CPGStatus.CURRENT,
            url="https://www.moh.gov.my",
            keywords=["PPH", "postpartum haemorrhage", "uterine atony", "obstetric hemorrhage"]
        ),
        # Emergency and Critical Care
        CPG(
            title="Clinical Practice Guidelines: Management of Sepsis in Adults",
            category=CPGCategory.EMERGENCY_CRITICAL_CARE,
            organization="Ministry of Health Malaysia",
            year=2020,
            version="2nd Edition",
            status=CPGStatus.CURRENT,
            url="https://www.moh.gov.my",
            keywords=["sepsis", "septic shock", "SIRS", "qSOFA", "SOFA", "ICU"]
        ),
        CPG(
            title="Clinical Practice Guidelines: Management of Acute Stroke",
            category=CPGCategory.EMERGENCY_CRITICAL_CARE,
            organization="Ministry of Health Malaysia",
            year=2020,
            version="2nd Edition",
            status=CPGStatus.CURRENT,
            url="https://www.moh.gov.my",
            keywords=["stroke", "ischemic stroke", "hemorrhagic stroke", "tPA", "thrombolysis"]
        ),
        CPG(
            title="Clinical Practice Guidelines: Management of Chest Pain",
            category=CPGCategory.EMERGENCY_CRITICAL_CARE,
            organization="Ministry of Health Malaysia",
            year=2019,
            version="2nd Edition",
            status=CPGStatus.CURRENT,
            url="https://www.moh.gov.my",
            keywords=["chest pain", "acute coronary syndrome", "ACS", "troponin"]
        ),
        # Infection Control
        CPG(
            title="Clinical Practice Guidelines: Antibiotic Usage",
            category=CPGCategory.INFECTION_CONTROL,
            organization="Ministry of Health Malaysia",
            year=2019,
            version="2nd Edition",
            status=CPGStatus.CURRENT,
            url="https://www.moh.gov.my",
            keywords=["antibiotic", "antimicrobial", "AMR", "resistance", "stewardship"]
        ),
        CPG(
            title="Clinical Practice Guidelines: Hand Hygiene",
            category=CPGCategory.INFECTION_CONTROL,
            organization="Ministry of Health Malaysia",
            year=2019,
            version="3rd Edition",
            status=CPGStatus.CURRENT,
            url="https://www.moh.gov.my",
            keywords=["hand hygiene", "infection control", "WHO 5 moments", "alcohol hand rub"]
        ),
        # Surgery and Anesthesia
        CPG(
            title="Clinical Practice Guidelines: Anaesthesia",
            category=CPGCategory.SURGERY_ANESTHESIA,
            organization="Ministry of Health Malaysia",
            year=2020,
            version="3rd Edition",
            status=CPGStatus.CURRENT,
            url="https://www.moh.gov.my",
            keywords=["anaesthesia", "anesthesia", "GA", "spinal", "regional", "ASA"]
        ),
        CPG(
            title="Clinical Practice Guidelines: Venous Thromboembolism Prophylaxis",
            category=CPGCategory.SURGERY_ANESTHESIA,
            organization="Ministry of Health Malaysia",
            year=2019,
            version="2nd Edition",
            status=CPGStatus.CURRENT,
            url="https://www.moh.gov.my",
            keywords=["VTE", "DVT", "pulmonary embolism", "thromboprophylaxis", "heparin"]
        ),
        # Oncology
        CPG(
            title="Clinical Practice Guidelines: Management of Breast Cancer",
            category=CPGCategory.ONCOLOGY,
            organization="Ministry of Health Malaysia",
            year=2020,
            version="2nd Edition",
            status=CPGStatus.CURRENT,
            url="https://www.moh.gov.my",
            keywords=["breast cancer", "mastectomy", "chemotherapy", "hormone therapy", "HER2"]
        ),
        CPG(
            title="Clinical Practice Guidelines: Palliative Care",
            category=CPGCategory.ONCOLOGY,
            organization="Ministry of Health Malaysia",
            year=2019,
            version="2nd Edition",
            status=CPGStatus.CURRENT,
            url="https://www.moh.gov.my",
            keywords=["palliative", "end-of-life", "hospice", "symptom control", "pain management"]
        ),
        # Renal and Urology
        CPG(
            title="Clinical Practice Guidelines: Management of Chronic Kidney Disease",
            category=CPGCategory.RENAL_UROLOGY,
            organization="Ministry of Health Malaysia",
            year=2018,
            version="2nd Edition",
            status=CPGStatus.CURRENT,
            url="https://www.moh.gov.my",
            keywords=["CKD", "chronic kidney disease", "renal", "dialysis", "eGFR"]
        ),
        # Neurology
        CPG(
            title="Clinical Practice Guidelines: Management of Epilepsy",
            category=CPGCategory.NEUROLOGY,
            organization="Ministry of Health Malaysia",
            year=2020,
            version="2nd Edition",
            status=CPGStatus.CURRENT,
            url="https://www.moh.gov.my",
            keywords=["epilepsy", "seizure", "antiepileptic", "EEG"]
        ),
        # Gastroenterology
        CPG(
            title="Clinical Practice Guidelines: Management of Peptic Ulcer Disease",
            category=CPGCategory.GASTROENTEROLOGY,
            organization="Ministry of Health Malaysia",
            year=2019,
            version="2nd Edition",
            status=CPGStatus.CURRENT,
            url="https://www.moh.gov.my",
            keywords=["PUD", "peptic ulcer", "H. pylori", "PPI", "gastric"]
        ),
    ]
    
    for cpg in cpg_list:
        db.add(cpg)
    
    return db
```

---

## 3. PDF Processing for RAG

```python
from langchain_community.document_loaders import PyPDFLoader
from langchain.schema import Document
from typing import List, Tuple
import re

class CPGParser:
    """Parser for Malaysian CPG PDFs."""
    
    def __init__(self, cpg: CPG):
        self.cpg = cpg
    
    def load_and_parse(self, pdf_path: str) -> List[Document]:
        """Load and parse CPG PDF into chunks."""
        
        loader = PyPDFLoader(pdf_path)
        pages = loader.load_and_split()
        
        documents = []
        
        for page_num, page in enumerate(pages, start=1):
            content = page.page_content
            
            # Extract sections
            sections = self._extract_sections(content)
            
            for section_title, section_content in sections:
                doc = Document(
                    page_content=section_content,
                    metadata={
                        "source_type": "cpg",
                        "source": "moh_malaysia",
                        "title": self.cpg.title,
                        "category": self.cpg.category.value,
                        "organization": self.cpg.organization,
                        "year": self.cpg.year,
                        "version": self.cpg.version,
                        "page": page_num,
                        "section": section_title,
                        "url": self.cpg.url,
                        "keywords": self.cpg.keywords
                    }
                )
                documents.append(doc)
        
        return documents
    
    def _extract_sections(self, content: str) -> List[Tuple[str, str]]:
        """Extract sections from page content."""
        
        # Common CPG section headers
        section_patterns = [
            r'^\d+\.\s+[A-Z]',  # 1. INTRODUCTION
            r'^\d+\.\d+\s+[A-Z]',  # 1.1 DEFINITION
            r'^[A-Z\s]+:$',  # RECOMMENDATIONS:
            r'^TABLE\s+\d+',  # TABLE 1
            r'^FIGURE\s+\d+',  # FIGURE 1
        ]
        
        sections = []
        current_section = "General"
        current_content = []
        
        lines = content.split('\n')
        
        for line in lines:
            line = line.strip()
            
            # Check if line is a section header
            is_header = False
            for pattern in section_patterns:
                if re.match(pattern, line, re.IGNORECASE):
                    # Save previous section
                    if current_content:
                        sections.append((current_section, '\n'.join(current_content)))
                    current_section = line
                    current_content = []
                    is_header = True
                    break
            
            if not is_header and line:
                current_content.append(line)
        
        # Add last section
        if current_content:
            sections.append((current_section, '\n'.join(current_content)))
        
        return sections if sections else [("General", content)]


class CPGIndex:
    """Index for CPG documents in vector store."""
    
    def __init__(self, vector_store):
        self.vector_store = vector_store
        self.cpg_db = create_moh_cpg_database()
    
    def add_cpg(self, pdf_path: str, cpg: CPG):
        """Add a CPG to the vector store."""
        
        parser = CPGParser(cpg)
        documents = parser.load_and_parse(pdf_path)
        
        self.vector_store.add_documents(documents)
        print(f"Added {len(documents)} chunks from {cpg.title}")
    
    def search(self, query: str, category: str = None, year: int = None, 
               k: int = 5) -> List[Document]:
        """Search CPGs with filters."""
        
        # Build filter
        filter_dict = {"source_type": "cpg", "source": "moh_malaysia"}
        
        if category:
            filter_dict["category"] = category
        if year:
            filter_dict["year"] = year
        
        return self.vector_store.similarity_search(
            query=query,
            k=k,
            filter=filter_dict
        )
    
    def get_recommendations(self, condition: str) -> List[CPG]:
        """Get CPGs relevant to a medical condition."""
        
        matching_cpgs = []
        
        for cpg in self.cpg_db.cpgs:
            # Check keywords and title
            search_text = cpg.title.lower() + ' ' + ' '.join(cpg.keywords).lower()
            
            if condition.lower() in search_text:
                matching_cpgs.append(cpg)
        
        # Sort by year (most recent first)
        return sorted(matching_cpgs, key=lambda x: x.year, reverse=True)
```

---

## 4. Specialty Society Guidelines

### Malaysian Diabetes Association (MDA)
- **URL**: https://www.diabetes.org.my
- **Key Guidelines**:
  - Malaysia Clinical Practice Guidelines for Type 2 Diabetes Mellitus (2020)
  - Diabetes Management in Primary Care
  - Diabetes and Pregnancy

### National Heart Association of Malaysia (NHAM)
- **URL**: https://www.nham.com.my
- **Key Guidelines**:
  - Acute Coronary Syndrome Management
  - Heart Failure Management
  - Hypertension Guidelines
  - Dyslipidaemia Management
  - Atrial Fibrillation Management

### Malaysian Society of Anaesthesiologists (MSA)
- **URL**: https://www.msah.net.my
- **Key Guidelines**:
  - Anaesthesia Guidelines
  - Sedation Guidelines
  - Pain Management
  - Critical Care Protocols

### Malaysian Thoracic Society (MTS)
- **URL**: https://www.malaysianthoracic.org.my
- **Key Guidelines**:
  - Asthma Management
  - COPD Management
  - Sleep Medicine
  - Tuberculosis

### Malaysian Society of Gastroenterology & Hepatology (MSGH)
- **URL**: https://msgh.org.my
- **Key Guidelines**:
  - Hepatitis Management
  - IBD Guidelines
  - Gastrointestinal Bleeding

### Malaysian Society of Nephrology (MSN)
- **Key Guidelines**:
  - Chronic Kidney Disease Management
  - Dialysis Guidelines
  - Renal Transplantation

### Malaysian Psychiatric Association (MPA)
- **URL**: https://www.psychiatry-malaysia.org
- **Key Guidelines**:
  - Depression Management
  - Anxiety Disorders
  - Schizophrenia Treatment

### Malaysian Orthopaedic Association (MOA)
- **Key Guidelines**:
  - Osteoarthritis Management
  - Fracture Management
  - Spinal Disorders

### Malaysian Urological Association (MUA)
- **Key Guidelines**:
  - Prostate Cancer
  - Urinary Stones
  - BPH Management

### Malaysian Paediatric Association (MPA)
- **URL**: https://www.mpaweb.org.my
- **Key Guidelines**:
  - Immunisation Schedule
  - Neonatal Guidelines
  - Common Paediatric Conditions

### Malaysian Society of Clinical Oncology (MSCO)
- **Key Guidelines**:
  - Breast Cancer
  - Colorectal Cancer
  - Lung Cancer

---

## 5. Quick Reference: Common CPG Scenarios

```python
CPG_SCENARIOS = {
    "diabetes_type2": {
        "keywords": ["diabetes", "T2DM", "hyperglycaemia"],
        "cpgs": [
            "Clinical Practice Guidelines: Management of Type 2 Diabetes Mellitus",
            "Clinical Practice Guidelines: Management of Diabetic Foot"
        ],
        "specialty": "Endocrinology"
    },
    "chest_pain": {
        "keywords": ["chest pain", "ACS", "MI", "angina"],
        "cpgs": [
            "Clinical Practice Guidelines: Management of Acute Coronary Syndrome",
            "Clinical Practice Guidelines: Management of Chest Pain"
        ],
        "specialty": "Cardiology"
    },
    "dengue": {
        "keywords": ["dengue", "fever", "DHF"],
        "cpgs": ["Clinical Practice Guidelines: Management of Dengue"],
        "specialty": "Infectious Disease"
    },
    "sepsis": {
        "keywords": ["sepsis", "septic shock", "SIRS"],
        "cpgs": ["Clinical Practice Guidelines: Management of Sepsis in Adults"],
        "specialty": "Critical Care"
    },
    "stroke": {
        "keywords": ["stroke", "CVA", "ischemic", "hemorrhagic"],
        "cpgs": ["Clinical Practice Guidelines: Management of Acute Stroke"],
        "specialty": "Neurology"
    },
    "hypertension": {
        "keywords": ["hypertension", "high blood pressure"],
        "cpgs": ["Clinical Practice Guidelines: Management of Hypertension"],
        "specialty": "Cardiology"
    },
    "tuberculosis": {
        "keywords": ["TB", "tuberculosis", "cough"],
        "cpgs": ["Clinical Practice Guidelines: Management of Tuberculosis"],
        "specialty": "Respiratory Medicine"
    },
    "covid19": {
        "keywords": ["COVID", "SARS-CoV-2", "coronavirus"],
        "cpgs": ["Clinical Practice Guidelines: Management of COVID-19"],
        "specialty": "Infectious Disease"
    }
}


def get_cpg_for_scenario(scenario: str) -> dict:
    """Get CPG recommendations for a clinical scenario."""
    return CPG_SCENARIOS.get(scenario, {"cpgs": [], "keywords": [], "specialty": "General"})
```

---

## 6. CPG Update Monitoring

```python
import hashlib
import time
from datetime import datetime

class CPGMonitor:
    """Monitor CPG updates from MOH."""
    
    def __init__(self, db: CPGDatabase):
        self.db = db
        self.checksums = {}
    
    def check_for_updates(self) -> List[CPG]:
        """Check if any CPGs have been updated."""
        
        updated = []
        
        for cpg in self.db.cpgs:
            try:
                # In practice, this would check the actual URL
                current_hash = self._get_remote_hash(cpg.url)
                
                if cpg.title not in self.checksums:
                    self.checksums[cpg.title] = current_hash
                elif self.checksums[cpg.title] != current_hash:
                    updated.append(cpg)
                    self.checksums[cpg.title] = current_hash
                    
            except Exception as e:
                print(f"Error checking {cpg.title}: {e}")
        
        return updated
    
    def _get_remote_hash(self, url: str) -> str:
        """Get hash of remote CPG file."""
        # Placeholder - would need actual implementation
        return hashlib.md5(str(time.time()).encode()).hexdigest()


def schedule_cpg_updates(monitor: CPGMonitor, interval_hours: int = 24):
    """Schedule periodic CPG update checks."""
    
    import schedule
    
    schedule.every(interval_hours).hours.do(
        lambda: monitor.check_for_updates()
    )
    
    while True:
        schedule.run_pending()
        time.sleep(60)
```

---

## 7. Summary Table

| Category | Count | Examples |
|----------|-------|----------|
| Non-Communicable Diseases | 18 | Diabetes, Hypertension, CVD, Mental Health |
| Communicable Diseases | 16 | Dengue, TB, HIV, COVID-19, Malaria |
| Maternal & Child Health | 12 | Antenatal, Neonatal, Immunisation |
| Emergency & Critical Care | 11 | Sepsis, Stroke, Trauma, Poisoning |
| Infection Control | 8 | Antibiotic Usage, Hand Hygiene |
| Surgery & Anesthesia | 6 | Anaesthesia, VTE Prophylaxis, Blood Transfusion |
| Oncology | 7 | Breast, Colorectal, Palliative Care |
| Renal & Urology | 7 | CKD, Dialysis, UTI |
| Neurology | 5 | Epilepsy, Migraine, Stroke |
| Gastroenterology | 6 | PUD, GERD, Hepatitis |
| **Total** | **~96** | |

---

## 8. Implementation Priority

### Phase 1 (High Priority)
1. Diabetes Management CPG
2. Hypertension CPG
3. Dengue Management CPG
4. Tuberculosis CPG
5. Sepsis Management CPG
6. Acute Coronary Syndrome CPG

### Phase 2 (Medium Priority)
1. COVID-19 CPG
2. Asthma/COPD CPG
3. Stroke Management CPG
4. Depression/Mental Health CPG
5. Antibiotic Usage CPG

### Phase 3 (Additional)
1. Maternal Health CPGs
2. Pediatric CPGs
3. Oncology CPGs
4. Renal CPGs
5. Other specialty guidelines

---

## References

- Ministry of Health Malaysia CPG Portal: https://www.moh.gov.my/index.php/pages/view/clinical-practice-guidelines
- Malaysian Diabetes Association: https://www.diabetes.org.my
- National Heart Association of Malaysia: https://www.nham.com.my
- Malaysian Society of Anaesthesiologists: https://www.msah.net.my
- Malaysian Thoracic Society: https://www.malaysianthoracic.org.my
- Malaysian Society of Gastroenterology & Hepatology: https://msgh.org.my
- Malaysian Psychiatric Association: https://www.psychiatry-malaysia.org
